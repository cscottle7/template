# SOP: Inter-Agent Communication Protocol (IACP)

## 1.0 Purpose
This protocol defines the mandatory, structured JSON format for all messages between the Orchestrator AI and its sub-agents. This protocol ensures that all communications are clear, auditable, and machine-readable, forming the basis of a reliable and observable agentic system.

## 2.0 Message Structure
Every message exchanged between agents MUST adhere to the following JSON structure.

| Field | Type | Description |
| :--- | :--- | :--- |
| **`message_id`** | UUID | A unique identifier for this specific message, ensuring traceability. |
| **`conversation_id`** | String | A shared identifier linking all messages related to a single `task_deps.md` task ID. This is crucial for tracking the lifecycle of a task. |
| **`sender_agent`** | String | The unique name of the agent sending the message (e.g., `/dev:implement-pro`). |
| **`receiver_agent`** | String | The unique name of the agent designated to receive the message (e.g., `/workflow:run_automated`). |
| **`timestamp`** | ISO 8 toning | The UTC timestamp when the message was sent. |
| **`performative`** | Enum | The communicative act of the message, making its intent explicit. Valid values include: `REQUEST_ACTION`, `INFORM_RESULT`, `REPORT_ERROR`, `CONFIRM_ACTION`. |
| **`payload`** | Object | The core content of the message. The structure of the payload depends on the performative. |
| **`metadata`** | Object | An object for governance and operational data. This MUST be populated by the Orchestrator upon receiving a message from a sub-agent. |

## 3.0 Enhanced Metadata Object
The `metadata` object provides granular, real-time cost tracking for every agent action and MUST contain the following fields:

| Field | Type | Description |
| :--- | :--- | :--- |
| **`model_name`** | String | The specific identifier of the language model used to generate the message's payload (e.g., "claude-3-5-sonnet-20240620"). |
| **`prompt_tokens`** | Integer | The number of tokens sent to the model as input to generate the response. |
| **`completion_tokens`**| Integer | The number of tokens generated by the model as the response. |
| **`actual_cost_usd`** | Float | The calculated monetary cost of the API call, derived from the token counts and the model's specific pricing. |